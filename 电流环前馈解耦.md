# 电流环前馈解耦

## 直流电机前馈解耦

**直流电机电压方程**


$$
V=Ri+L\frac{di}{dt}+e
$$

$$
V-E=\frac{1}{Cs+R}
$$



进行前馈是为了将传递函数变为一阶惯性环节，如下


$$
V=\frac{1}{Cs+R}+E
$$


在前面加上E这个增益


$$
E=\omega_m·K_T
$$


即


$$
V_{ff} = \omega _m · K_T
$$


即可变换，然后方便算出


$$
K_p 和 K_i
$$



通过**前馈解耦**得到**一阶惯性表达式**再由一阶惯性表达式得到**Kp和Ki**


$$
K_p = L·\omega _c\\
K_i = R·\omega _c
$$






## 由一阶惯性环节传递函数得到Kp和Ki

### 1. 一阶惯性环节传递函数

一般的一阶惯性环节传递函数形式如下：


$$
G(s) = \frac{K}{1 + T_i s}
$$


其中：

- \( K \) 是传递函数的增益（通常称为比例增益 \( K_p \)）。

- \( T_i \) 是传递函数的积分时间常数（与积分增益 \( K_i \) 相关，）。

  

$$
T_i = \frac{1}{K_i}
$$

### 2. 确定 \( K_p \)

比例增益 K_p  即为传递函数的增益 K 。

### 3. 确定 \( K_i \)

传递函数的积分时间常数 \( T_i \) 与积分增益 \( K_i \) 的关系如下：


$$
T_i = \frac{1}{K_i}
$$


因此，


$$
K_i = \frac{1}{T_i} 
$$



### 示例

假设有一个一阶惯性环节的传递函数为：


$$
G(s) = \frac{2}{1 + 3s} 
$$



根据上述一般形式，可以识别出：

- \( K = 2 \)（比例增益 \( K_p \)）
- \( T_i = 3 \)（积分时间常数）

因此：
- 比例增益 \( K_p = K = 2 \)

- 积分时间常数 \( T_i = 3 \)，因此积分增益  

  

$$
K_i = \frac{1}{T_i} = \frac{1}{3}
$$



## 异步电机矢量控制闭环

### 1.从异步电机出发得到Id和Iq

异步电机IM（induction motor）

输出


$$
i_{as}\\
i_{bs}\\
i_{cs}
$$



三相电流，再经过Park变换转为


$$
i_{ds}\\i_{qs}
$$


在异步电机中，定子dq轴电流的作用如下：

1. **定子d轴电流（Id）**：

   - **作用**：控制电机的磁场产生。Id电流决定了在定子坐标系的d轴上的磁场分量。
   - **影响**：增大或减小Id会改变电机定子内部的磁场强度。通过控制Id，可以调节电机的磁场强度，从而影响电机的输出转矩。

2. **定子q轴电流（Iq）**：

   - **作用**：控制电机的转矩产生。Iq电流决定了在定子坐标系的q轴上的磁场分量。

   - **影响**：增大或减小Iq会改变电机在定子坐标系中的转矩产生能力。通过控制Iq，可以调节电机的输出转矩，实现对电机负载的精确控制。

     

### **2. 得到Vd\***

先确定一个需要的磁场大小 


$$
λ^* 
$$



根据磁场大小计算出 id大小


$$
i_{ds}^*
$$



通过ids*和真实的ids做差


$$
e_{ids}
$$



通过ACR变换得到（d轴电压标准值）


$$
V_d^*
$$


### **3.得到Vq\***

首先需要理想转速(转速控制)


$$
\omega^*
$$


再通过测得的真正转速


$$
\omega
$$


做差得到


$$
e_\omega
$$


把它通过ASR（转速控制器）得到电流标准值


$$
i_{qs}^*
$$



再和真正的


$$
i_{qs}
$$


做差得到


$$
e_{iqs}
$$


将它通过ACR（电流控制器）得到


$$
V_q^*
$$



### **4.得到Vas、Vbs、Vcs三相定子电压**

用Vd\*和Vq\*通过SVPWM得到Vas、Vbs、Vcs

### 5.把三相电压通过逆变器交给电机

最后，把三相电压通过逆变器交给电机，完成闭环矢量控制SOC



## 为什么要进行前馈解耦

得到Vd\*和Vq\*的两条路的方法有耦合



dq坐标系下电压方程：


$$
V_{ds}^e=Ri_{ds}^e+p\lambda_{ds}^e-\omega_e\lambda_{qs}^e \\ 
V_{qs}^e=Ri_{qs}^e+p\lambda_{qs}^e-\omega_e\lambda_{qs}^e
$$



（p代表微分）

推导过程略过

最终电压方程


$$
V_{ds}^e=(R_s+R_r\frac{L_m^2}{L_r^2})i_{ds}^e+\sigma L_s\frac{di_{ds}^e}{dt}-\omega_e\sigma L_si_{qs}^e-R_r\frac{L_m}{L_r^2}\lambda_{dr}^e\\
V_{qs}^e=(R_s+R_r\frac{L_m^2}{L_r^2})i_{qs}^e+\sigma L_s\frac{di_{qs}^e}{dt}+\omega_e\sigma L_si_{ds}^e+\omega_r\frac{L_m}{L_r}\lambda_{qr}^e
$$


可以用


$$
R=R_s+R_r\frac{L_m^2}{L_r^2}\\
L=\sigma L_s
$$


替换，然后转换可得Kp和Ki


$$
K_p = \sigma L_s · \omega_c\\
K_i = [R_s + R_r(\frac{L_m}{L_r})^2] · \omega_c
$$


可以通过电压方程看出耦合的部分:


$$
V_{ds\_ff}^e = -\omega_e\sigma L_si_{qs}^e - R_r\frac{L_m}{L_r^2}\lambda_{dr}^e\\
V_{qs\_ff}^e = \omega_e\sigma L_si_{ds}^e + \omega_r\frac{L_m}{L_r}\lambda_{dr}^e
$$


下面对耦合部分的参数进行解释

1. dq变换中坐标轴旋转速度
   
   
   $$
   \omega _e
   $$

​    

​    因为做的是转子磁链定向矢量控制，所以d轴与转子磁链方向重合，因此w_e也就是**转子磁链的转速**

​	**注意**：**转子机械转速**：w_m是转子物理转速  **转子电转速**：w_r

​	n_p是极对数,**转子电转速略慢于转子磁链转速**


$$
\omega_e - \omega_r = \omega_{sl} 
$$
​	

​	sl是转差率（slip）或者s（和间接矢量控制有关）

2. σ ：漏磁系数 

   
   $$
   \sigma = 1- \frac{L_m^2}{L_r \cdot L_s}
   $$

   

3. R_r :转子每一相的电阻

4. L_m L_s L_r K_T见 [异步电机的自身参数](##异步电机的自身参数)

   

## 异步电机转速关系

1. **转子机械转速 n_m（Rotor Mechanical Speed）**： 

   这是转子本身的实际旋转速度，通常以转每分钟 (rpm) 表示。

2. **转子电转速  n_r（Rotor Electrical Speed）**：

    这是转子在电角度上的旋转速度。电角度速度与机械角度速度的关系如下：
    
    

$$
n_s = n_p · n_r
$$

​	

 	其中，n_p 是电机的极对数。例如，对于两极电机，P=1；对于四极电机，P=2。

3. **同步转速 n_s（Synchronous Speed）**：

   这是磁场在定子中旋转的速度，取决于电源频率 f 和电机的极对数 n_p。公式如下：

   
   $$
   n_s = \frac{120 · f}{P}
   $$
   
4. **转差率 s（Slip）**： 转差率表示转子速度与同步速度之间的差异。公式如下：

    

$$
s= \frac{n_s - n_r}{n_s}
$$

​	

转差率 s 通常以百分比表示。

5. **转子磁链转速**： 转子磁链转速实际上等同于同步转速，因为转子磁链（或磁场）是由定子产生的旋转磁场所引起的，因此其转速即为同步转速 n_s。



**转子电转速略慢于转子磁链转速**

原因可以通过理解异步电机的工作原理来解释。主要原因在于转差率（slip）。

在异步电机中，定子绕组通过交流电产生一个旋转磁场，这个旋转磁场以同步转速 \( n_s \) 旋转。转子位于这个旋转磁场中，并受到感应电流的作用，产生电磁力，从而带动转子旋转。

然而，如果转子的转速与同步转速完全一致（即转差率为零），转子导体中的相对运动为零，因此不会产生感应电流，也不会产生驱动转矩。因此，为了产生电流和转矩，转子的实际机械转速 \( n_m \) 必须略低于同步转速 \( n_s \)。这个速度差就是转差率 \( s \)。

转差率 \( s \) 定义为：


$$
s = \frac{n_s - n_m}{n_s}
$$


因此，转子机械转速 \( n_m \) 可以表示为：



$$
n_m = n_s \cdot (1 - s)
$$



转子电转速 \( n_r\) 是机械转速与电角度转换的结果，定义为：


$$
n_{r} = n_p \cdot n_m
$$


其中 \( P \) 是电机的极对数。

由于 \( n_r \) 略低于 \( n_s \)，所以转子电转速 \( n_{re} \) 也略低于转子磁链转速 \( n_s \)（因为转子磁链转速即为同步转速）。换句话说，转子的电转速与其机械转速之间的关系同样受到转差率的影响，导致转子电转速略慢于转子磁链转速。

- 转子磁链转速（同步转速） \( n_s \) 由电源频率和极对数决定。
- 转子机械转速 \( n_m \) 略低于同步转速 \( n_s \)，因为必须有转差来产生电流和转矩。
- 转子电转速 \( n_r\) 是机械转速 \( n_m \) 转换到电角度后的速度，因此也略低于同步转速 \( n_s \)。



## 异步电机的自身参数

### 异步电机中的电感参数

在异步电机（感应电机）的等效电路中，定子和转子绕组的电感通常表示为以下几个参数：

1. **定子自感 \( L_s \)（Stator Self-Inductance）**：
   定子自感 \( L_s \) 是定子绕组本身的电感。它包括定子绕组的漏电感和与转子磁链相耦合的电感部分。

2. **转子自感 \( L_r \)（Rotor Self-Inductance）**：
   转子自感 \( L_r \) 是转子绕组本身的电感。它包括转子绕组的漏电感和与定子磁链相耦合的电感部分。

3. **互感 \( L_m \)（Magnetizing Inductance）**：
   互感 \( L_m \) 是定子和转子之间的互感电感，反映了定子和转子之间的磁耦合程度。互感是由于定子和转子之间的磁通链产生的，它是转子与定子之间传递能量的主要途径。

#### 这些电感在等效电路中的表示：

- **定子漏电感 \( L_{ls} \)**：
  这是定子绕组的漏电感部分，表示定子磁通中未与转子耦合的部分。
  
- **转子漏电感 \( L_{lr} \)**：
  这是转子绕组的漏电感部分，表示转子磁通中未与定子耦合的部分。

- **总定子电感 \( L_s \)**：
  包含定子自感和互感的总电感：
  
  
  $$
  L_s = L_{ls} + L_m
  $$
  
- **总转子电感 \( L_r \)**：
  包含转子自感和互感的总电感：
  
  
  $$
  L_r = L_{lr} + L_m
  $$



#### 关系总结：

- 定子自感 \( L_s \) 包含定子漏电感和互感部分。
- 转子自感 \( L_r \) 包含转子漏电感和互感部分。
- 互感 \( L_m \) 反映定子和转子之间的磁耦合。

在异步电机的等效电路中，这些电感参数是分析电机性能和特性的关键。理解这些参数有助于分析电机的磁路和电气特性，进而优化电机设计和控制策略。

### 转矩常数 \( K_T \)

在异步电机（感应电机）的分析和控制中，常用到一个称为转矩常数（Torque Constant）的参数，通常记为 \( K_T \)。转矩常数 \( K_T \) 是电机产生的电磁转矩与流过电机电流之间的比例常数。它的定义和用途如下：

#### 定义

转矩常数 \( K_T \) 表示电机在单位电流下产生的转矩。其定义为：


$$
K_T = \frac{T_e}{I}
$$


其中：

- \( T_e \) 是电机的电磁转矩。
- \( I \) 是电机的电流。

#### 物理意义

- **转矩输出与电流的关系**：转矩常数 \( K_T \) 直接反映了电机在给定电流下能够产生的转矩。因此，它是电机设计和性能评估中的重要参数。
- **控制策略中的应用**：在矢量控制（Vector Control）或场定向控制（Field-Oriented Control, FOC）等高级电机控制策略中，转矩常数 \( K_T \) 用于计算所需的电流参考值，以产生期望的转矩输出。

#### 计算公式

对于感应电机，电磁转矩 \( T_e \) 可以用以下公式计算：


$$
T_e = \frac{3}{2} \cdot \frac{P}{2} \cdot \frac{L_m}{L_r} \cdot \frac{I_s^2 \cdot R_r}{s}
$$


其中：

- \( P \) 是极对数。
- \( L_m \) 是互感电感。
- \( L_r \) 是转子自感电感。
- \( I_s \) 是定子电流。
- \( R_r \) 是转子电阻。
- \( s \) 是转差率。

#### 关系总结

- **转矩常数 \( K_T \)** 是电机的一个重要参数，它表征了电流与电磁转矩之间的线性关系。
- 在电机控制中，精确的 \( K_T \) 值有助于实现精确的转矩控制。
- \( K_T \) 的值可以通过实验测量或根据电机参数计算得出。

#### 重要注意事项

在具体应用中，\( K_T \) 的数值可能受电机参数（如电阻、感应电感等）和工作条件（如温度、磁饱和等）的影响，因此在使用 \( K_T \) 时，通常需要考虑这些因素的变化。